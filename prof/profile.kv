<EditProfileScreen>:
    name: 'edit_profile'
    FloatLayout:
        Image:
            source: 'prof/backgourd_prof.jpg'
            allow_stretch: True
            keep_ratio: False
            size_hint: (1, 1)
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        BoxLayout:
            orientation: 'vertical'
            padding: [50, 10, 50, 10]
            spacing: 10
            size_hint: (0.8, 0.9)
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            canvas.before:
                Color:
                    rgba: (0.95, 0.95, 0.95, 0.8)  # Light grey background
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: [20,]

            BoxLayout:
                orientation: 'horizontal'
                spacing: 10
                BoxLayout:
                    orientation: 'vertical'
                    spacing: 10
                    size_hint: (0.4, 1)
                    Image:
                        id: profile_pic
                        source: 'default_profile.png'
                        allow_stretch: True
                        keep_ratio: True
                    Button:
                        text: 'Choose Image'
                        background_color: (0.2, 0.6, 0.86, 1)
                        color: (1, 1, 1, 1)
                        on_release: root.choose_image()
                        size_hint_y: 0.22
                        height: 10
                        radius: [10,]
                BoxLayout:
                    orientation: 'vertical'
                    size_hint: (0.6, 1)
                    spacing: 5
                    Label:
                        text: 'Change Nickname'
                        font_size: 20
                        color: (0, 0, 0, 1)
                    TextInput:
                        id: nickname
                        hint_text: 'New Nickname'
                        multiline: False
                        write_tab: False
                        padding: [10, 10]
                        background_color: (1, 1, 1, 1)
                        foreground_color: (0, 0, 0, 1)

                    Label:
                        text: 'About'
                        font_size: 20
                        color: (0, 0, 0, 1)
                    TextInput:
                        id: about
                        hint_text: 'Something about you'
                        write_tab: False
                        padding: [10, 10]
                        background_color: (1, 1, 1, 1)
                        foreground_color: (0, 0, 0, 1)

            BoxLayout:
                orientation: 'vertical'
                spacing: 5
                Label:
                    text: 'Change Password'
                    font_size: 20
                    color: (0, 0, 0, 1)
                TextInput:
                    id: current_password
                    hint_text: 'Current Password'
                    multiline: False
                    password: True
                    write_tab: False
                    background_color: (1, 1, 1, 1)
                    foreground_color: (0, 0, 0, 1)

                TextInput:
                    id: new_password
                    hint_text: 'New Password'
                    multiline: False
                    password: True
                    write_tab: False
                    background_color: (1, 1, 1, 1)
                    foreground_color: (0, 0, 0, 1)

                TextInput:
                    id: confirm_password
                    hint_text: 'Confirm New Password'
                    multiline: False
                    password: True
                    write_tab: False
                    background_color: (1, 1, 1, 1)
                    foreground_color: (0, 0, 0, 1)

                Label:
                    id: error
                    text: ''
                    color: 1, 0, 0, 1
                    size_hint_y: 0.25
                    height: self.texture_size[1]

            BoxLayout:
                orientation: 'horizontal'
                spacing: 5
                size_hint: (1, 0.35)
                pos_hint: {'center_x': 0.5}

                Button:
                    text: 'Save'
                    background_color: (0.2, 0.6, 0.86, 1)
                    color: (1, 1, 1, 1)
                    on_release: root.save_profile(about.text, nickname.text, current_password.text, new_password.text, confirm_password.text, profile_pic.source)
                    size_hint_y: None
                    height: 50
                    radius: [10,]

                Button:
                    text: 'Cancel'
                    background_color: (0.2, 0.6, 0.86, 1)
                    color: (1, 1, 1, 1)
                    on_release: app.root.current = 'profile'
                    size_hint_y: None
                    height: 50
                    radius: [10,]